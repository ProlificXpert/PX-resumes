<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Upload Resume — ProlificXpert</title>
<style>
:root{
  --blue:#007BFF;
  --green:#28a745;
  --grad1:#0ea5a4;
  --grad2:#007BFF;
  --card:#fff;
  --muted:#6b7280;
  --radius:14px;
}
*{box-sizing:border-box;}
body{
  font-family:"Segoe UI",Roboto,system-ui,-apple-system,"Helvetica Neue",Arial;
  margin:0;
  padding:20px;
  background:linear-gradient(180deg,#f4f8ff 0%,#fff 60%);
  display:flex;
  justify-content:center;
  align-items:flex-start;
  min-height:100vh;
  color:#0f172a;
}
.stage{width:100%;max-width:900px;margin:auto;}
.hero{text-align:center;margin-bottom:20px;}
.hero h1{
  margin:0;font-size:28px;font-weight:800;
  background:linear-gradient(90deg,var(--grad1),var(--grad2));
  -webkit-background-clip:text;background-clip:text;color:transparent;
}
.hero p{margin-top:8px;font-size:14px;color:var(--muted);}

/* Card */
.card{
  background:var(--card);
  border-radius:var(--radius);
  padding:26px;
  box-shadow:0 12px 40px rgba(14,22,47,0.08);
  position:relative;
  border-top:6px solid;
  border-image:linear-gradient(90deg,var(--grad1),var(--grad2)) 1;
}

/* Form */
form .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px 18px;}
.full{grid-column:1/-1;}
.section-title{grid-column:1/-1;font-size:15px;font-weight:700;margin:4px 0 8px;}
.field label{display:block;margin-bottom:6px;font-weight:600;font-size:14px;color:#0b6f4a;}
.input-wrap{
  display:flex;align-items:center;gap:10px;
  background:#fbfbff;border:1px solid #e6e9ef;padding:12px;border-radius:10px;
  transition:.18s;
}
.input-wrap input, .input-wrap textarea{flex:1;border:none;outline:none;font-size:15px;background:transparent;}
.input-wrap:focus-within{border-color:var(--blue);box-shadow:0 6px 20px rgba(2,132,199,0.12);}
textarea{min-height:54px;resize:vertical;}
.file-preview{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  background:#f9fffb;border:1px dashed #d6e8d9;padding:12px;border-radius:10px;font-size:14px;flex-wrap:wrap;
}
.file-meta{display:flex;align-items:center;gap:10px}
.file-meta small{font-size:12px;color:var(--muted)}
.actions{grid-column:1/-1;margin-top:6px;}
.btn{
  width:100%;padding:14px;border-radius:12px;background:linear-gradient(90deg,var(--grad1),var(--grad2));
  color:white;font-size:16px;font-weight:700;border:0;cursor:pointer;
  display:flex;align-items:center;justify-content:center;gap:8px;
}
.spinner{width:18px;height:18px;border:2px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:spin .8s linear infinite;}
@keyframes spin{to{transform:rotate(360deg)}}

/* Modal */
.modal-backdrop{
  position:fixed;inset:0;background:rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;transition:opacity .18s;z-index:99;
}
.modal-backdrop.show{opacity:1;pointer-events:all;}
.modal{
  width:90%;max-width:420px;background:white;border-radius:14px;padding:22px;text-align:center;
  box-shadow:0 20px 60px rgba(0,0,0,0.2);
}
.modal h3{margin:0 0 8px;font-size:20px;color:#064e23;}
.modal p{color:var(--muted);margin:0 0 14px;}
.link{display:inline-block;background:linear-gradient(90deg,var(--grad1),var(--grad2));color:white;padding:10px 14px;border-radius:10px;text-decoration:none;font-weight:700;}

/* Mobile adjustments */
@media(max-width:700px){
  .grid{grid-template-columns:1fr;gap:14px;}
  .card{padding:18px;}
  .hero h1{font-size:22px;}
  .file-preview{flex-direction:column;align-items:flex-start;}
  .input-wrap{padding:12px;}
  .btn{padding:14px;font-size:15px;}
}

@media(max-width:480px){
  body{padding:12px;}
  .hero h1{font-size:20px;}
  .btn{font-size:15px;padding:12px;}
  .input-wrap{padding:10px;}
  .card{padding:16px;}
  #chooseBtn{width:100%; text-align:center;}
  .file-preview{font-size:13px;}
  .modal{width:95%;padding:16px;}
  /* --- UNIVERSAL MOBILE FIXES --- */

/* Prevent iPhone Safari zoom on inputs */
input, textarea {
  font-size: 16px !important;
}

/* Main mobile fix */
@media (max-width: 820px) {

  body {
    padding: 12px !important;
  }

  .stage {
    width: 100%;
  }

  .hero h1 {
    font-size: 22px !important;
  }

  /* Force single column layout */
  .grid {
    grid-template-columns: 1fr !important;
    gap: 14px !important;
  }

  .card {
    padding: 18px !important;
    border-radius: 12px;
  }

  /* Fix input spacing */
  .input-wrap {
    padding: 12px !important;
    min-height: 46px;
    align-items: center;
  }

  /* Section title alignment */
  .section-title {
    margin-top: 10px;
    margin-bottom: 6px;
    font-size: 15px;
  }

  /* Make file input layout perfect */
  .field .input-wrap {
    flex-direction: row !important;
    justify-content: space-between;
  }

  /* Browse Button */
  #chooseBtn {
    padding: 10px 14px !important;
    font-size: 14px !important;
    border-radius: 10px;
    white-space: nowrap;
  }

  /* Fix file preview box */
  .file-preview {
    flex-direction: column !important;
    align-items: flex-start !important;
    font-size: 14px;
    padding: 12px !important;
  }

  .file-meta {
    flex-wrap: wrap;
  }

  /* Form button */
  .btn {
    font-size: 15px !important;
    padding: 14px !important;
    border-radius: 12px;
  }

  /* Modal fix for small screens */
  .modal {
    width: 92% !important;
    padding: 18px !important;
    border-radius: 12px;
  }
}

/* Extra small devices (older phones, small Android) */
@media (max-width: 480px) {

  .hero h1 {
    font-size: 20px !important;
  }

  .input-wrap {
    padding: 10px !important;
  }

  .btn {
    padding: 12px !important;
  }

  #chooseBtn {
    width: 100% !important;
    margin-top: 8px;
  }

  /* Stack the file input layout on very small screens */
  .field .input-wrap {
    flex-direction: column !important;
    align-items: flex-start !important;
  }
}

}
</style>
</head>
<body>
<div class="stage">
  <div class="hero">
    <h1>Upload Your Resume</h1>
    <p>Submit your profile — our team will review and get back to you.</p>
  </div>
  <div class="card">
    <form id="uploadForm" autocomplete="off">
      <div class="grid">

        <div class="section-title">Personal Info</div>
        <div class="field"><label for="name">Full name</label><div class="input-wrap"><input id="name" name="name" type="text" placeholder="e.g. Priya Sharma" required></div></div>
        <div class="field"><label for="email">Email</label><div class="input-wrap"><input id="email" name="email" type="email" placeholder="you@company.com" required></div></div>
        <div class="field"><label for="phone">Phone</label><div class="input-wrap"><input id="phone" name="phone" type="text" placeholder="+91 98765 43210" required></div></div>
        <div class="field"><label for="location">Location</label><div class="input-wrap"><input id="location" name="location" type="text" placeholder="City, State" required></div></div>

        <div class="section-title">Experience</div>
        <div class="field"><label for="total_experience">Total Experience (Years)</label><div class="input-wrap"><input id="total_experience" name="total_experience" type="number" min="0" step="0.1" required></div></div>
        <div class="field"><label for="relevant_experience">Relevant Experience (Years)</label><div class="input-wrap"><input id="relevant_experience" name="relevant_experience" type="number" min="0" step="0.1" required></div></div>
        <div class="full field"><label for="skills">Skills</label><div class="input-wrap"><input id="skills" name="skills" type="text" placeholder="e.g. Manual testing, Selenium, SQL" required></div></div>

        <div class="section-title">Salary</div>
        <div class="field"><label for="current_ctc">Current CTC (Annual)</label><div class="input-wrap"><input id="current_ctc" name="current_ctc" type="number" min="0" step="0.01" required></div></div>
        <div class="field"><label for="expected_ctc">Expected CTC (Annual)</label><div class="input-wrap"><input id="expected_ctc" name="expected_ctc" type="number" min="0" step="0.01" required></div></div>

        <div class="section-title full">Resume</div>
        <div class="full field">
          <label for="file">Upload Resume</label>
          <div class="input-wrap" style="justify-content:space-between;gap:12px;position:relative;">
            <div style="flex:1;font-weight:700;color:#0b6f4a">Choose file or drag here</div>
            <input id="file" name="file" type="file" style="opacity:0;position:absolute;right:12px;top:12px;height:40px;width:120px">
            <button type="button" id="chooseBtn" style="border-radius:10px;padding:8px 12px;border:0;background:#eef9f0;color:var(--green);font-weight:700;cursor:pointer">Browse</button>
          </div>
          <div id="previewArea" style="margin-top:12px;display:none"></div>
        </div>

        <div class="actions">
          <button id="submitBtn" class="btn" type="submit">
            <span id="btnLabel">Submit Application</span>
            <span id="btnSpinner" style="display:none" class="spinner" aria-hidden="true"></span>
          </button>
        </div>

      </div>
    </form>
  </div>
</div>

<!-- Success Modal -->
<div id="modal" class="modal-backdrop" role="dialog" aria-hidden="true">
  <div class="modal" role="document">
    <h3>Resume uploaded successfully</h3>
    <p>Our team will review your profile and contact you soon.</p>
    <a id="fileLink" class="link" target="_blank" rel="noopener">Open Resume</a>
    <div style="margin-top:12px">
      <button onclick="closeModal()" style="margin-top:12px;padding:8px 12px;border-radius:8px;border:1px solid #e6eef9;background:#fff;cursor:pointer">Close</button>
    </div>
  </div>
</div>

<script>
(function(){
  const scriptURL = "https://script.google.com/macros/s/AKfycbw-M8W1n2pFXy8Qk_JO47ZCnfoKifuokvb04N-gKGp8EPH66tO6sivSHhWpPE8QOfg/exec"; // replace with your URL
  const form = document.getElementById('uploadForm');
  const fileInput = document.getElementById('file');
  const chooseBtn = document.getElementById('chooseBtn');
  const previewArea = document.getElementById('previewArea');
  const submitBtn = document.getElementById('submitBtn');
  const btnSpinner = document.getElementById('btnSpinner');
  const btnLabel = document.getElementById('btnLabel');
  const modalBackdrop = document.getElementById('modal');
  const fileLink = document.getElementById('fileLink');

  chooseBtn.addEventListener('click', ()=> fileInput.click());

  // Drag & drop
  const card = document.querySelector('.card');
  ['dragenter','dragover'].forEach(evt=> card.addEventListener(evt,e=>{e.preventDefault(); card.style.opacity='0.98';}));
  ['dragleave','drop'].forEach(evt=> card.addEventListener(evt,e=>{e.preventDefault(); card.style.opacity='1';}));
  card.addEventListener('drop', e=>{ 
    if(e.dataTransfer.files.length){ 
      fileInput.files=e.dataTransfer.files; 
      handleFileSelect(); 
    } 
  });

  fileInput.addEventListener('change', handleFileSelect);

  function handleFileSelect(){
    const f = fileInput.files[0];
    if(!f){ previewArea.style.display='none'; previewArea.innerHTML=''; return; }
    const maxMB=5; 
    if(f.size/(1024*1024)>maxMB){ 
      alert('File too large (max 5MB)'); 
      fileInput.value=''; 
      previewArea.style.display='none'; 
      return; 
    }
    previewArea.style.display='block';
    previewArea.innerHTML=`
      <div class="file-preview">
        <div class="file-meta"><div style="font-weight:700">${f.name}</div><small>${(f.size/(1024*1024)).toFixed(2)} MB</small></div>
        <button id="removeFile" type="button" style="background:transparent;border:0;color:var(--muted);cursor:pointer">Remove</button>
      </div>`;
    document.getElementById('removeFile').addEventListener('click',()=>{fileInput.value=''; previewArea.style.display='none'; previewArea.innerHTML='';});
  }

  form.addEventListener('submit', async function(e){
    e.preventDefault();
    if(!fileInput.files[0]){ alert('Please attach your resume'); return; }
    submitBtn.setAttribute('disabled',''); btnSpinner.style.display='inline-block'; btnLabel.textContent='Uploading...';

    try{
      const f=fileInput.files[0];
      const reader=new FileReader();
      reader.readAsDataURL(f);
      reader.onload=async function(){
        const base64 = reader.result.split(',')[1];
        const payload = {
          name:document.getElementById('name').value.trim(),
          email:document.getElementById('email').value.trim(),
          phone:document.getElementById('phone').value.trim(),
          location:document.getElementById('location').value.trim(),
          total_experience:document.getElementById('total_experience').value,
          relevant_experience:document.getElementById('relevant_experience').value,
          skills:document.getElementById('skills').value.trim(),
          current_ctc:document.getElementById('current_ctc').value,
          expected_ctc:document.getElementById('expected_ctc').value
        };
        const formData=new FormData();
        formData.append('filename',f.name);
        formData.append('mimetype',f.type||'application/octet-stream');
        formData.append('filedata',base64);
        formData.append('data',JSON.stringify(payload));

        const res=await fetch(scriptURL,{method:'POST',body:formData});
        const json=await res.json();
        if(json.status==='success'){
          fileLink.href=json.fileUrl||'#';
          fileLink.textContent=json.fileUrl?'View uploaded resume':'Open Resume';
          openModal(); form.reset(); previewArea.style.display='none'; previewArea.innerHTML='';
        }else{ throw new Error(json.message||'Server error'); }
      };
      reader.onerror=()=>{ throw new Error('Failed to read file'); };
    }catch(err){ alert('Upload failed: '+err.message); console.error(err); }
    finally{ submitBtn.removeAttribute('disabled'); btnSpinner.style.display='none'; btnLabel.textContent='Submit Application'; }
  });

  window.openModal = ()=>{modalBackdrop.classList.add('show'); modalBackdrop.setAttribute('aria-hidden','false');};
  window.closeModal = ()=>{modalBackdrop.classList.remove('show'); modalBackdrop.setAttribute('aria-hidden','true');};
  modalBackdrop.addEventListener('click', e=>{ if(e.target===modalBackdrop) closeModal(); });

  // Adjust Browse button width on mobile
  function updateChooseBtnWidth(){
    if(window.innerWidth <= 480) chooseBtn.style.width = "100%";
    else chooseBtn.style.width = "auto";
  }
  window.addEventListener('resize', updateChooseBtnWidth);
  updateChooseBtnWidth();
})();
</script>
</body>
</html>
